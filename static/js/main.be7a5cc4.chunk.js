(this.webpackJsonpspc_formatter=this.webpackJsonpspc_formatter||[]).push([[0],[,,,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r=n(2),a=n.n(r),s=n(7),c=n.n(s),o=n(1),i=n(3),u=n(5),h=n(4),l=n(0),p=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var t=this;document.getElementById("text").addEventListener("keypress",(function(e){13!==e.which||e.shiftKey||(e.preventDefault(),t.props.parseText(e.target.value))}))}},{key:"render",value:function(){return Object(l.jsx)("div",{id:"textarea",children:Object(l.jsx)("textarea",{id:"text",value:this.props.text,onChange:this.props.setText})})}}]),n}(a.a.Component),f=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var t=this;return Object(l.jsxs)("div",{id:this.props.label+"Checkbox",children:[Object(l.jsx)("input",{type:this.props.type,id:this.props.label,name:this.props.name,onChange:function(){return t.props.passInfo(t.props.label)},checked:this.props.checked}),Object(l.jsx)("label",{htmlFor:this.props.label,children:this.props.label})]})}}]),n}(a.a.Component),d=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"createCheckboxes",value:function(){var t=this;return this.props.instruments.map((function(e){return Object(l.jsx)(f,{label:e,type:"radio",name:"instruments",passInfo:function(){return t.props.setCurrInstr(e)},checked:e===t.props.instrument},e)}))}},{key:"render",value:function(){var t=this;return Object(l.jsxs)("div",{id:"InstrumentMenuContainer",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Instruments"}),Object(l.jsx)("form",{id:"InstrumentMenuForm",children:this.createCheckboxes()})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Track Length"}),Object(l.jsx)("input",{type:"number",value:this.props.trackLength,onChange:function(e){t.props.changeTrackLength(e.target.value)}})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Measure Length"}),Object(l.jsx)("input",{type:"number",value:this.props.measureLength,onChange:function(e){t.props.changeMeasureLength(e.target.value)}})]})]})}}]),n}(a.a.Component),g=n(8),k=function(t){for(var e=t.numOfMeasures,n=t.measureLen,r=void 0===n?4:n,a=[Object(l.jsx)("div",{className:"measureHeader",style:{gridColumn:"1"}})],s=0;s<e;s++)a[s+1]=Object(l.jsx)("div",{className:"measureHeader",style:{gridColumn:"".concat(s*r*4+2," / span ").concat(4*r)},children:s+1});return a},x={1:"C",2:"C#",3:"D",4:"D#",5:"E",6:"F",7:"F#",8:"G",9:"G#",10:"A",11:"A#",12:"B"},v=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(t=e.call.apply(e,[this].concat(a))).getNoteName=function(){return 1===t.props.note?Object(l.jsxs)("div",{className:"keyText",children:["C",t.props.octave]}):Object(l.jsx)("div",{className:"keyText",children:x[t.props.note]})},t}return Object(i.a)(n,[{key:"render",value:function(){return Object(l.jsx)("div",{className:"pianoKey".concat(x[this.props.note]),style:{gridRow:Math.abs(this.props.note+12*(this.props.octave-1)-j-1)+1},children:this.getNoteName()})}}]),n}(a.a.Component),m=function(t){var e=t.length,n=t.setNoteLength,r=t.inc,a=t.changeAmount,s=t.text,c=t.marginLeft;return Object(l.jsx)("div",{onClick:function(){n(r?e+a:e-a)},style:{marginLeft:c?"auto":"2px",marginRight:"2px",width:"auto",fontWeight:"bold",color:"white",fontSize:"12px",display:"flex",alignItems:"center"},children:s})},O=function(t){var e=t.noteInfo,n=t.index,r=t.removeNote,a=t.setDraggedNote,s=t.setNoteLength,c=function(t){s(t,n)};return Object(l.jsxs)("div",{className:"trackPianoNote",onContextMenu:function(t){t.preventDefault(),r(n)},onDragStart:function(){a({note:e,index:n})},style:{gridColumn:"".concat(e.location+1," / span ").concat(e.length),gridRow:"".concat(Math.abs(parseInt(Object.entries(x).find((function(t){return t[1]==="".concat(e.note.toUpperCase()[0]).concat(e.sharp?"#":"")}))[0])+12*(e.octave-1)-j)+2,"\n          / span 1")},draggable:!0,children:[e.length>4?Object(l.jsx)(m,{length:e.length,setNoteLength:c,inc:!1,changeAmount:4,text:"<<",marginLeft:!1}):null,Object(l.jsx)(m,{length:e.length,setNoteLength:c,inc:!1,changeAmount:1,text:"<",marginLeft:!1}),Object(l.jsx)(m,{length:e.length,setNoteLength:c,inc:!0,changeAmount:1,text:">",marginLeft:!0}),e.length>3?Object(l.jsx)(m,{length:e.length,setNoteLength:c,inc:!0,changeAmount:4,text:">>",marginLeft:!1}):null]},n)},j=72,b=function(t){var e=t.track,n=t.tracks,a=t.addNote,s=t.removeNote,c=t.replaceNote,o=t.setNoteLength,i=Object(r.useState)(null),u=Object(g.a)(i,2),h=u[0],p=u[1],f=function(t){t.preventDefault()};return n[e]?Object(l.jsxs)("div",{className:"trackPianoRoll",style:{gridTemplateRows:"repeat(".concat(j,", 8.2%)"),gridTemplateColumns:"20% repeat(".concat(n[e].track_length*n[e].measure_length*4,", 5%)")},children:[Object(l.jsx)(k,{numOfMeasures:n[e].track_length,measureLen:n[e].measure_length}),function(){for(var t=[],e=1;e<=12;e++)for(var n=1;n<=6;n++)t.push(Object(l.jsx)(v,{note:e,octave:n}));return t}(),function(){for(var t=[],r=function(r){for(var s=function(s){for(var o=(r-2)%n[e].measure_length===n[e].measure_length-1,i=function(i){var u="1px solid black";o&&3===i?u="4px solid black":3===i&&(u="2px solid black"),t.push(Object(l.jsx)("div",{className:"trackPianoRollGrid",onClick:function(){!function(t,r){for(var s=t,c=0;c<n[e].notes.length;c+=1)if(n[e].notes[c].location<=s+3&&n[e].notes[c].location+n[e].notes[c].length-1>=s)return;var o=13===Math.abs(r%12-13)?1:Math.abs(r%12-13),i=Math.abs(Math.ceil(r/12)-7);a(s,o,i)}(4*(r-2)+1+i,s-1)},onDragOver:f,onDrop:function(t){!function(t,r,a){if(t.preventDefault(),h){for(var s=r,o=0;o<n[e].notes.length;o+=1)if(o!==h.index&&n[e].notes[o].location<=s+h.note.length-1&&n[e].notes[o].location+n[e].notes[o].length-1>=s)return;h.note.location=s,h.note.note=13===Math.abs(a%12-13)?1:Math.abs(a%12-13),h.note.octave=Math.abs(Math.ceil(a/12)-7),c(h),p(null)}}(t,4*(r-2)+1+i,s-1)},style:{gridRow:"".concat(s),gridColumn:"".concat(4*(r-2)+2+i),borderRight:u}}))},u=0;u<4;u++)i(u)},o=2;o<=j+1;o++)s(o)},s=2;s<=n[e].track_length*n[e].measure_length+1;s++)r(s);return t}(),n[e].notes.map((function(t,e){return t?Object(l.jsx)(O,{noteInfo:t,index:e,removeNote:s,setDraggedNote:p,setNoteLength:o}):null}))]}):null},T=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"renderTrackOptions",value:function(){return this.props.tracks.map((function(t){return Object(l.jsxs)("option",{value:t.trackId,children:["Track ",t.trackId]},t.trackId)}))}},{key:"render",value:function(){var t=this;return Object(l.jsx)("select",{value:this.props.currTrack,onChange:function(e){e.preventDefault(),t.props.setCurrTrack(parseInt(e.target.value))},children:this.renderTrackOptions()})}}]),n}(a.a.Component),N=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(l.jsxs)("div",{id:"editorarea",children:[Object(l.jsx)(T,{tracks:this.props.tracks,currTrack:this.props.currTrack,setCurrTrack:this.props.setCurrTrack}),Object(l.jsx)(b,{track:this.props.currTrack,tracks:this.props.tracks,addNote:this.props.addNote,removeNote:this.props.removeNote,replaceNote:this.props.replaceNote,setNoteLength:this.props.setNoteLength}),Object(l.jsx)("div",{style:{display:"flex"},children:Object(l.jsx)(d,{instruments:this.props.instruments,instrument:this.props.tracks[this.props.currTrack].instrument,trackLength:this.props.tracks[this.props.currTrack].track_length,measureLength:this.props.tracks[this.props.currTrack].measure_length,setCurrInstr:this.props.setCurrInstr,changeTrackLength:this.props.changeTrackLength,changeMeasureLength:this.props.changeMeasureLength})})]})}}]),n}(a.a.Component),y=function t(e){var n=this;Object(o.a)(this,t),this.trackId=0,this.notes=[],this.instrument="Flute",this.volume=255,this.octave_start=1,this.default_length=-1,this.track_length=6,this.measure_length=4,this.setInstrument=function(t){var e=n;return e.instrument=t,e},this.trackId=e};y.MAX_TRACK_NUM=8;var L=y,C=function t(){Object(o.a)(this,t),this.location=1,this.note="c",this.sharp=!1,this.length=1,this.octave=5},I=function(){function t(){Object(o.a)(this,t)}return Object(i.a)(t,null,[{key:"parse",value:function(t,e){for(var n=e.split("#"),r=2;r<n.length;r++){var a=parseInt(n[r][0],10);if(-1!==n[r].indexOf("w")){for(var s=n[r].indexOf("w")+1,c="";n[r][s]>="0"&&n[r][s]<="9";)c+=n[r][s],s++;t.volume=parseInt(c,10)}if(-1!==n[r].indexOf("t")){for(var o=n[r].indexOf("t")+1,i="";n[r][o]>="0"&&n[r][o]<="9";)i+=n[r][o],o++;t.tempo=parseInt(i,10)}if(-1!==n[r].indexOf("@"))switch(n[r][n[r].indexOf("@")+1]){case"0":t.tracks[a].instrument=t.instruments[0];break;case"1":t.tracks[a].instrument=t.instruments[1];break;case"3":t.tracks[a].instrument=t.instruments[2];break;case"8":t.tracks[a].instrument=t.instruments[3];break;case"9":t.tracks[a].instrument=t.instruments[4]}if(-1!==n[r].indexOf("v")){for(var u=n[r].indexOf("v")+1,h="";n[r][u]>="0"&&n[r][u]<="9";)h+=n[r][u],u++;t.tracks[a].volume=parseInt(h,10)}if(-1!==n[r].indexOf("o")){for(var l=n[r].indexOf("o")+1,p="";n[r][l]>="0"&&n[r][l]<="9";)p+=n[r][l],l++;t.tracks[a].octave_start=parseInt(p,10)}if(-1!==n[r].indexOf("l")){for(var f=n[r].indexOf("l")+1,d="";n[r][f]>="0"&&n[r][f]<="9";)d+=n[r][f],f++;t.tracks[a].default_length=parseInt(d,10)}var g=t.tracks[a].octave_start,k=-1,x=[],v=1,m=n[r].length;n[r].indexOf("a")<m&&n[r].indexOf("a")>0&&(m=n[r].indexOf("a")),n[r].indexOf("b")<m&&n[r].indexOf("b")>0&&(m=n[r].indexOf("b")),n[r].indexOf("c")<m&&n[r].indexOf("c")>0&&(m=n[r].indexOf("c")),n[r].indexOf("d")<m&&n[r].indexOf("d")>0&&(m=n[r].indexOf("d")),n[r].indexOf("e")<m&&n[r].indexOf("e")>0&&(m=n[r].indexOf("e")),n[r].indexOf("f")<m&&n[r].indexOf("f")>0&&(m=n[r].indexOf("f")),n[r].indexOf("g")<m&&n[r].indexOf("g")>0&&(m=n[r].indexOf("g")),n[r].indexOf("r")<m&&n[r].indexOf("r")>0&&(m=n[r].indexOf("r")),n[r].indexOf("<")<m&&n[r].indexOf("<")>0&&(m=n[r].indexOf("<")),n[r].indexOf(">")<m&&n[r].indexOf(">")>0&&(m=n[r].indexOf(">"));for(var O=m;O<n[r].length;O++){var j=!1;if("<"===n[r][O]&&g--,">"===n[r][O]&&g++,-1!=="abcdefgr".indexOf(n[r][O])&&("r"===n[r][O]?j=!0:(void 0===x[++k]&&x.push(new C),x[k].note=n[r][O],x[k].length=16/t.tracks[a].default_length,x[k].octave=g,x[k].location=v),-1!==t.tracks[a].default_length&&(v+=16/t.tracks[a].default_length)),n[r][O]>="0"&&n[r][O]<="9"){for(var b="";n[r][O]>="0"&&n[r][O]<="9";)b+=n[r][O],O++;O--,j||(x[k].length=16/parseInt(b,10)),v+=16/parseInt(b,10)}"+"===n[r][O]&&(x[k].sharp=!0)}t.tracks[a].notes=x}return t}}]),t}(),_=function(){function t(){Object(o.a)(this,t)}return Object(i.a)(t,null,[{key:"update",value:function(t,e){for(var n=t.split("#"),r=!1,a=0;a<e.tracks.length;a++)0!==e.tracks[a].notes.length&&(r=!0);if(!r&&1===n.length)return t;t="#amk 2\n\n";for(var s=0;s<e.tracks.length;s++)if(0!==e.tracks[s].notes.length){t+="#"+s,0===s&&(t+=" w"+e.volume+" t"+e.tempo),t+="\n@"+this.getInstrument(e.tracks[s].instrument)+" v"+e.tracks[s].volume+" o"+e.tracks[s].octave_start,-1!==e.tracks[s].default_length&&(t+=" l"+e.tracks[s].default_length),t+="\n\n";for(var c=e.tracks[s].octave_start,o=null,i=0;i<e.tracks[s].notes.length;i++){for(null!==o&&(console.log("test"),e.tracks[s].notes[i].location-(o.location+o.length)>0&&(t+="r"+this.noteToLength(e.tracks[s].notes[i].location-(o.location+o.length)))),o=e.tracks[s].notes[i];e.tracks[s].notes[i].octave>c;)c++,t+=">";for(;e.tracks[s].notes[i].octave<c;)c--,t+="<";t+=e.tracks[s].notes[i].note,e.tracks[s].notes[i].sharp&&(t+="+"),this.noteToLength(e.tracks[s].notes[i].length)!==e.tracks[s].default_length&&(t+=this.noteToLength(e.tracks[s].notes[i].length))}t+="\n\n"}return t}},{key:"getInstrument",value:function(t){switch(t){case"Flute":return"0";case"Strings":return"1";case"Marimba":return"3";case"Bass":return"8";case"Piano":return"9";default:return null}}},{key:"getInstrumentName",value:function(t){switch(t){case"0":return"Flute";case"1":return"Strings";case"3":return"Marimba";case"8":return"Bass";case"9":return"Piano";default:return null}}},{key:"setCharAt",value:function(t,e,n){return e>t.length-1?t:t.substring(0,e)+n+t.substring(e+1)}},{key:"noteToLength",value:function(t){switch(t){case 1:return 16;case 2:return 8;case 3:return 6;case 4:return 4;case 5:case 6:return 3;case 7:case 8:return 2;case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:return 1;default:return 0}}}]),t}(),M=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var r;Object(o.a)(this,n),(r=e.call(this,t)).setCurrTrack=function(t){r.setState({currTrack:t}),r.updateText(r.state)},r.setCurrInstr=function(t){var e=r.state.tracks;e[r.state.currTrack].instrument=t,r.setState({tracks:e}),r.updateText(r.state)},r.addNote=function(t,e,n){var a=r.state.tracks,s=new C;s.location=t,s.note=x[e][0].toLowerCase(),"#"===x[e][1]&&(s.sharp=!0),s.octave=n,a[r.state.currTrack].notes.push(s),r.setState({tracks:a}),r.updateText(r.state)},r.removeNote=function(t){var e=r.state.tracks;e[r.state.currTrack].notes.splice(t,1),r.setState({tracks:e}),r.updateText(r.state)},r.replaceNote=function(t){var e=t.note,n=t.index,a=e.note,s=r.state.tracks;e.note=x[a][0].toLowerCase(),e.sharp="#"===x[a][1],s[r.state.currTrack].notes.splice(n,1,e),r.setState({tracks:s}),r.updateText(r.state)},r.setNoteLength=function(t,e){if(!(t<1)){var n=r.state.tracks,a=n[r.state.currTrack].notes[e];a.length=t;for(var s=0;s<n[r.state.currTrack].notes.length;s+=1)if(s!==e&&n[r.state.currTrack].notes[s].location<=a.location+t-1&&n[r.state.currTrack].notes[s].location+n[r.state.currTrack].notes[s].length-1>=a.location)return;n[r.state.currTrack].notes[e]=a,r.setState({tracks:n}),r.updateText(r.state)}},r.changeTrackLength=function(t){var e=r.state.tracks;e[r.state.currTrack].track_length=t,r.setState({tracks:e}),r.updateText(r.state)},r.changeMeasureLength=function(t){var e=r.state.tracks;e[r.state.currTrack].measure_length=t,r.setState({tracks:e}),r.updateText(r.state)},r.setText=function(t){r.setState({text:t.target.value})},r.parseText=function(t){r.setState(I.parse(r.state,t))},r.updateText=function(t){r.setState({text:_.update(r.state.text,t)})};for(var a=[],s=0;s<L.MAX_TRACK_NUM;s+=1)a.push(new L(s));return r.state={example:!1,tracks:a,volume:255,tempo:40,instruments:["Flute","Strings","Marimba","Bass","Piano"],currTrack:0,text:"Paste your AddmusicK compatible syntax text here."},r}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.setState(this.state)}},{key:"render",value:function(){return Object(l.jsxs)("div",{id:"main",children:[Object(l.jsx)(N,{example:this.state.example,instruments:this.state.instruments,tracks:this.state.tracks,currTrack:this.state.currTrack,setCurrTrack:this.setCurrTrack,setCurrInstr:this.setCurrInstr,addNote:this.addNote,removeNote:this.removeNote,replaceNote:this.replaceNote,setNoteLength:this.setNoteLength,changeTrackLength:this.changeTrackLength,changeMeasureLength:this.changeMeasureLength}),Object(l.jsx)(p,{text:this.state.text,setText:this.setText,parseText:this.parseText})]})}}]),n}(a.a.Component);n(14),n(15),n(16),n(17),n(18);c.a.render(Object(l.jsx)(M,{}),document.getElementById("root"))}],[[19,1,2]]]);
//# sourceMappingURL=main.be7a5cc4.chunk.js.map